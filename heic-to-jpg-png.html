<!DOCTYPE html>
<html lang="en">
<head>
  <meta name="description" content="Free, fast, and private HEIC to JPG/PNG converter — everything runs in your browser (no uploads).">

  <meta charset="utf-8" />
  <meta http-equiv="Content-Security-Policy" content="script-src 'self' 'unsafe-inline' 'unsafe-eval' blob:; worker-src 'self' blob:;">
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>HEIC → JPG/PNG — Client-side</title>
  <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
  <link rel="stylesheet" href="/style.css" />
  <script defer src="/site.js"></script>
  <script defer src="/assets/seo.js"></script>
  <meta name="color-scheme" content="light dark" />

  <link rel="canonical" href="https://pdfimagelab.com/heic-to-jpg-png" />
  <meta property="og:title" content="HEIC to JPG/PNG — PDF Image Lab" />
  <meta property="og:description" content="Convert HEIC photos (from iPhone/iPad) to JPG or PNG directly in your browser. Private, fast, and free." />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://pdfimagelab.com/heic-to-jpg-png" />
</head>
<body class="tool-page">
<header class="site-header">
  <div class="container bar">
    <div class="brand">
      <a href="/" class="home-link">
        <span class="logo"></span>
        <span>PDFimageLab</span>
      </a>
    </div>

    <div class="container tool-tabs-wrap">
      <button class="tool-scroll tool-left" aria-label="Scroll tools left" title="Scroll left">‹</button>
      <nav class="tool-tabs" role="navigation" aria-label="Tools">
        <a href="/image-to-pdf">Image → PDF</a>
        <a href="/pdf-to-images">PDF → Images</a>
        <a href="/compress">Compress PDF</a>
        <a href="/crop">Crop PDF</a>
        <a href="/merge">Merge PDF</a>
        <a href="/png-to-jpg">PNG → JPG</a>
        <a href="/jpg-to-png">JPG → PNG</a>
        <a href="/heic-to-jpg-png" class="active">HEIC → JPG/PNG</a>
        <a href="/delete-pages">Delete pages</a>
        <a href="/reorder-pages">Reorder PDF</a>
        <a href="/rotate-pages">Rotate PDF</a>
      </nav>
      <button class="tool-scroll tool-right" aria-label="Scroll tools right" title="Scroll right">›</button>
    </div>
  </div>
</header>

<main>
  <div class="wrap">

    <!-- ===== 3-Box Panel ===== -->
    <aside class="panel">
      <div class="grid-3">

        <!-- 1) Upload -->
        <section class="panel card box upload-box theme-center" id="dropzone" aria-label="Upload">
          <h2 class="title">Upload</h2>
          <p class="muted">Drag &amp; drop HEIC images here</p>
          <label for="file" class="btn gradient big">Browse HEIC</label>
          <input
            id="file"
            type="file"
            accept=".heic,.heif,image/heic,image/heif,image/*"
            multiple
            hidden
          />
          <div class="pill mt-2" id="meta">No file</div>
          <button class="btn subtle mt-1" id="clearBtn" disabled>Clear</button>
          <div class="small mt-2">Everything runs in your browser (no uploads).</div>
        </section>

        <!-- 2) Settings -->
        <section class="panel card box settings-box theme-center" aria-label="Conversion Settings">
          <h2 class="title">Settings</h2>

          <label class="block mt-1">
            Choose output format
            <div class="select-wrap mt-1">
              <select id="format" class="select-lg">
                <option value="jpg" selected>JPG (smaller, universal)</option>
                <option value="png">PNG (lossless, larger)</option>
              </select>
              <span class="select-arrow"></span>
            </div>
          </label>

          <div id="jpgSettings" class="mt-2">
            <label class="block">JPG quality
              <input id="quality" type="range" min="0.5" max="0.99" step="0.01" value="0.92" />
            </label>
            <div class="small" id="qLabel">Quality: 0.92 (higher = better &amp; larger)</div>
          </div>

          <div class="small mt-2">
            Converts iPhone / iPad HEIC photos to clean JPG or PNG files on your device. No server, no tracking.
          </div>
        </section>

        <!-- 3) Action / Download -->
        <section class="panel card box action-box theme-center" aria-label="Convert & Download">
          <h2 class="title">Download</h2>

          <progress id="prog" max="100" value="0" class="w-100"></progress>
          <div id="status" class="small">Idle…</div>

          <div class="row center mt-2" style="gap:10px">
            <button id="convertBtn" class="btn" disabled>Convert &amp; Download</button>
            <button id="cancelBtn" class="btn ghost" style="display:none">Cancel</button>
          </div>
        </section>
      </div>
    </aside>

    <!-- ===== Title + How it works ===== -->
    <section class="tool-copy">
      <h1>HEIC to JPG or PNG — free, fast, private</h1>
      <p>
        Drop your <strong>.heic</strong> or <strong>.heif</strong> photos from iPhone, iPad, or Mac and instantly convert them
        to <strong>JPG</strong> or <strong>PNG</strong>. Everything happens locally in your browser,
        so your images never leave your device.
      </p>

      <h2>How to convert HEIC to JPG/PNG</h2>
      <ol>
        <li>Upload one or more HEIC files using drag &amp; drop or the “Browse HEIC” button.</li>
        <li>Choose your preferred output format (JPG or PNG).</li>
        <li>Optionally adjust JPG quality with the slider.</li>
        <li>Click <strong>Convert &amp; Download</strong> to save your images.</li>
      </ol>

      <p class="small mt-2">
        Tip: JPG is best for smaller file sizes and sharing; PNG is ideal when you want lossless images.
      </p>
      <p class="sub mt-1">Privacy: No uploads. Everything stays on your device.</p>
    </section>

  </div>

         <!-- libs: libheif-js WASM bundle, exposes global `libheif` -->
    <script src="https://cdn.jsdelivr.net/npm/libheif-js@1.19.8/libheif-wasm/libheif-bundle.js"></script>

    <!-- page script -->
    <script>
    (function () {
      const $ = (s) => document.querySelector(s);

      const fileInput   = $('#file');
      const dropzone    = $('#dropzone');
      const meta        = $('#meta');
      const clearBtn    = $('#clearBtn');
      const convertBtn  = $('#convertBtn');
      const cancelBtn   = $('#cancelBtn');
      const prog        = $('#prog');
      const statusEl    = $('#status');
      const formatEl    = $('#format');
      const jpgSettings = $('#jpgSettings');
      const qualityEl   = $('#quality');
      const qLabel      = $('#qLabel');

      let files = [];
      let cancelFlag = false;

      function setStatus(txt) {
        if (statusEl) statusEl.textContent = txt;
      }

      function setProgress(done, total) {
        if (!prog) return;
        if (!total) {
          prog.max = 1;
          prog.value = 0;
          return;
        }
        prog.max = total;
        prog.value = done;
      }

      function updateMeta() {
        if (!meta) return;
        if (!files.length) {
          meta.textContent = 'No file';
          clearBtn.disabled = true;
          convertBtn.disabled = true;
          convertBtn.classList.remove('primary-blue');
        } else if (files.length === 1) {
          meta.textContent = files[0].name;
          clearBtn.disabled = false;
          convertBtn.disabled = false;
          convertBtn.classList.add('primary-blue');
        } else {
          meta.textContent = files.length + ' files selected';
          clearBtn.disabled = false;
          convertBtn.disabled = false;
          convertBtn.classList.add('primary-blue');
        }
      }

      function downloadBlob(blob, originalName, ext) {
        const base = (originalName || 'image').replace(/\.[^.]+$/, '') || 'image';
        const a = document.createElement('a');
        a.href = URL.createObjectURL(blob);
        a.download = base + '.' + ext;
        document.body.appendChild(a);
        a.click();
        setTimeout(function () {
          URL.revokeObjectURL(a.href);
          a.remove();
        }, 1500);
      }

      // JPG quality label
      if (qualityEl && qLabel) {
        const updateQ = function () {
          var v = parseFloat(qualityEl.value || '0.92').toFixed(2);
          qLabel.textContent = 'Quality: ' + v + ' (higher = better & larger)';
        };
        qualityEl.addEventListener('input', updateQ);
        updateQ();
      }

      function refreshFormatUI() {
        if (!jpgSettings) return;
        jpgSettings.style.display = formatEl.value === 'jpg' ? '' : 'none';
      }
      formatEl.addEventListener('change', refreshFormatUI);
      refreshFormatUI();

      // ---------- File selection ----------
      fileInput.addEventListener('change', function (e) {
        var all = Array.prototype.slice.call(e.target.files || []);
        files = all.filter(function (f) {
          return /heic|heif/i.test(f.type) || /\.(heic|heif)$/i.test(f.name);
        });
        if (!files.length && all.length) {
          alert('Please select HEIC/HEIF images (.heic / .heif).');
        }
        updateMeta();
        setStatus(files.length ? 'Ready to convert.' : 'Idle…');
        setProgress(0, 0);
        fileInput.value = '';
      });

      // ---------- Drag & drop ----------
      ['dragenter', 'dragover'].forEach(function (ev) {
        dropzone.addEventListener(ev, function (e) {
          e.preventDefault();
          dropzone.classList.add('dropping');
        });
      });
      ['dragleave', 'drop'].forEach(function (ev) {
        dropzone.addEventListener(ev, function (e) {
          e.preventDefault();
          dropzone.classList.remove('dropping');
        });
      });
      dropzone.addEventListener('drop', function (e) {
        var all = Array.prototype.slice.call((e.dataTransfer && e.dataTransfer.files) || []);
        files = all.filter(function (f) {
          return /heic|heif/i.test(f.type) || /\.(heic|heif)$/i.test(f.name);
        });
        if (!files.length && all.length) {
          alert('Please select HEIC/HEIF images (.heic / .heif).');
        }
        updateMeta();
        setStatus(files.length ? 'Ready to convert.' : 'Idle…');
        setProgress(0, 0);
      });

      clearBtn.addEventListener('click', function () {
        files = [];
        fileInput.value = '';
        updateMeta();
        setStatus('Idle…');
        setProgress(0, 0);
      });

      cancelBtn.addEventListener('click', function () {
        cancelFlag = true;
        setStatus('Cancelling…');
      });

      function ensureLibheif() {
        if (!window.libheif || !window.libheif.HeifDecoder) {
          alert('HEIC engine (libheif) not loaded. Please refresh the page.');
          return false;
        }
        return true;
      }

      // low-level HEIC -> Blob helper using libheif
      function heicFileToBlob(file, mimeType, quality) {
        return file.arrayBuffer().then(function (buffer) {
          var uint8 = new Uint8Array(buffer);
          var decoder = new window.libheif.HeifDecoder();
          var images = decoder.decode(uint8);
          if (!images || !images.length) {
            throw new Error('No image found in HEIC file');
          }
          var image = images[0];
          var width = image.get_width();
          var height = image.get_height();
          var canvas = document.createElement('canvas');
          canvas.width = width;
          canvas.height = height;
          var ctx = canvas.getContext('2d');
          var imageData = ctx.createImageData(width, height);

          return new Promise(function (resolve, reject) {
            image.display(imageData, function (data) {
              if (!data) {
                reject(new Error('HEIF processing error'));
                return;
              }
              ctx.putImageData(imageData, 0, 0);
              image.free();
              canvas.toBlob(function (b) {
                if (!b) {
                  reject(new Error('Failed to create image blob'));
                } else {
                  resolve(b);
                }
              }, mimeType, quality);
            });
          });
        });
      }

      function runConvert() {
        if (!files.length) {
          setStatus('No files loaded. Please add at least one HEIC/HEIF file.');
          return;
        }
        if (!ensureLibheif()) return;

        var outIsPng = formatEl.value === 'png';
        var mimeType = outIsPng ? 'image/png' : 'image/jpeg';
        var ext = outIsPng ? 'png' : 'jpg';
        var jpgQuality = !outIsPng
          ? Math.max(0.5, Math.min(0.99, parseFloat(qualityEl.value || '0.92')))
          : undefined;

        convertBtn.disabled = true;
        cancelBtn.style.display = 'inline-flex';
        cancelFlag = false;

        setStatus('Converting ' + files.length + ' image' + (files.length > 1 ? 's' : '') + '…');
        setProgress(0, files.length);

        var done = 0;
        var sequence = Promise.resolve();

        files.forEach(function (f) {
          sequence = sequence.then(function () {
            if (cancelFlag) return;
            setStatus('Converting ' + (done + 1) + ' / ' + files.length + '…');

            return heicFileToBlob(f, mimeType, jpgQuality).then(function (blob) {
              downloadBlob(blob, f.name, ext);
              done += 1;
              setProgress(done, files.length);
            });
          });
        });

        sequence.then(function () {
          if (cancelFlag) {
            setStatus('Cancelled.');
          } else {
            setStatus('Done.');
          }
        }).catch(function (err) {
          console.error(err);
          alert('Conversion failed: ' + (err && err.message ? err.message : err));
          setStatus('Error.');
        }).finally(function () {
          convertBtn.disabled = false;
          cancelBtn.style.display = 'none';
        });
      }

      convertBtn.addEventListener('click', function () {
        runConvert();
      });

      // init
      updateMeta();
      setStatus('Idle…');
      setProgress(0, 0);
    })();
    </script>

</main>
</body>
</html>
